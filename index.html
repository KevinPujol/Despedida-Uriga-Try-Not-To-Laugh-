<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Generador de videos aleatorios</title>
  <meta name="description" content="P√°gina simple que muestra un video aleatorio de una lista (YouTube y TikTok)." />
  <style>
    :root {
      /* Paleta inspirada en la segunda imagen (web): fondos c√°lidos, texto oscuro y acento verde salvia */
      --bg: #f6f3f2;        /* fondo principal muy claro, c√°lido */
      --panel: #ffffff;     /* tarjetas/blancos */
      --accent: #6f836f;    /* verde salvia para acentos y botones */
      --text: #43312c;      /* marr√≥n oscuro/charcoal c√°lido para texto */
      --muted: #b6a9a4;     /* gris tostado para textos secundarios */
      --border: #e7e1df;    /* borde suave */
    }
    * { box-sizing: border-box }
    html, body { height: 100% }
    body {
      margin: 0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji";
      background: radial-gradient(1000px 700px at 80% -20%, #f0ebe9 0%, transparent 60%),
                  radial-gradient(800px 600px at -10% 10%, #efe9e6 0%, transparent 60%),
                  var(--bg);
      color: var(--text);
      display: grid;
      place-items: center;
      padding: 24px;
    }
    .card {
      width: min(960px, 100%);
      background: color-mix(in oklab, var(--panel) 86%, #faf6f4 14%);
      backdrop-filter: blur(6px) saturate(120%);
      border: 1px solid var(--border);
      border-radius: 20px;
      box-shadow: 0 10px 30px rgba(0,0,0,.08);
      padding: 18px;
    }
    .head { display: grid; justify-items: center; gap: 6px; padding: 12px 6px 16px }
    .brand { display: grid; justify-items: center; gap: 8px }
    .brand img { height: clamp(72px, 12vw, 160px); width: auto; display: block; object-fit: contain; }
    h1 { color: var(--accent); font-size: clamp(1.2rem, 2.2vw + .6rem, 1.8rem); margin: 0; letter-spacing: .2px }
    .muted { color: var(--muted); font-size: .95rem }

    .player-wrap { position: relative; width: 100%; }
    .ratio {
      width: 100%;
      aspect-ratio: 16 / 9;
      background: #f1ecea;
      border-radius: 14px;
      overflow: hidden;
      display: grid;
      place-items: center;
      border: 1px solid var(--border);
    }
    iframe, .tiktok-embed { width: 100%; height: 100% }

    .controls { display: flex; gap: 10px; flex-wrap: wrap; align-items: center; margin-top: 14px }
    .controls .counter { margin-left: auto }
    button, a.button {
      --pad: 12px 16px;
      appearance: none; border: 0; padding: var(--pad); border-radius: 12px; cursor: pointer;
      font-weight: 600; letter-spacing: .2px; text-decoration: none; display: inline-flex; align-items: center; gap: .55rem;
    }
    .primary { background: var(--accent); color: #ffffff }
    .secondary { background: #ffffff; color: var(--text); border: 1px solid var(--border); box-shadow: 0 1px 2px rgba(0,0,0,.06) }
    .secondary:hover { border-color: color-mix(in oklab, var(--border) 40%, var(--text) 60%); box-shadow: 0 2px 6px rgba(0,0,0,.08); transform: translateY(-1px) }
    .primary:hover { filter: brightness(1.05) }

    .info { display: grid; gap: 4px; margin-top: 6px }
    .small { font-size: .9rem }
    code.inline { background: #f0ecea; padding: 2px 6px; border-radius: 8px }

    .footer { margin-top: 12px; color: #8e837f; font-size: .85rem }
.footer .love { text-align: center; }

    .footer a { color: inherit }
    /* layout for title left / button right */
    .topbar { display:flex; justify-content: space-between; align-items:center; width: 100%; gap: 12px; flex-wrap: wrap }
    .topbar .left { display:grid; gap:4px; max-width: 75% }
    .topbar .right { display:flex; align-items:center }
    .brand { justify-self: center }

/* Ensure no divider under header */
.topbar { border-bottom: none !important; box-shadow: none !important; }

/* Mobile: center title, subtitle, and primary button */
@media (max-width: 640px) {
  .topbar { flex-direction: column; align-items: center; justify-content: center; gap: 8px; }
  .topbar .left, .topbar .right { max-width: 100%; width: 100%; display: flex; justify-content: center; }
  .topbar .left h1, .topbar .left .muted { text-align: center; }
}

</style>
</head>
<body>
  <main class="card">
    <div class="head">
      <div class="brand">
        <img src="logo.png" alt="Olga &amp; Oriol ‚Äì 04.10.2025" />
      </div>
      <div class="topbar">
        <div class="left">
          <h1>Generador de videos aleatorios</h1>
          <div class="muted">Soporta Youtube (inc. Shorts).</div>
        </div>
        <div class="right">
          <button id="shuffle" class="primary" title="Otro video" type="button">üîÄ Otro video</button>
        </div>
      </div>
    </div>
    <div class="player-wrap">
      <div id="player" class="ratio" aria-live="polite" aria-busy="false">
        <div class="muted small">Pulsa <strong>Otro video</strong> para empezar üîÄ</div>
      </div>
    </div>

    <div class="controls">
      <button id="openOriginal" class="secondary" type="button" hidden>Abrir en su app</button>
      <button id="copyLink" class="secondary" hidden>Copiar enlace</button>
      <span id="counter" class="small muted counter" hidden></span>
    </div>

    <div class="info small" id="meta" hidden>
      <div>Fuente: <code id="sourceHost" class="inline"></code></div>
      <div>URL: <code id="sourceUrl" class="inline" style="word-break: break-all"></code></div>
    </div>

    <div class="footer">Si alg√∫n video no permite <em>embed</em>, usa ‚ÄúAbrir en su app‚Äù.<br/><div class="love">Hecho con ‚ù§Ô∏è para Olga &amp; Oriol.</div></div>
  </main>

  <script>
  // === 1) Pega aqu√≠ tus enlaces (YouTube / TikTok) ===
  const LINKS = [
    "https://www.youtube.com/shorts/WJrTD-hvzqk",
    "https://www.youtube.com/watch?v=cDvBwePeebA",
    "https://www.youtube.com/watch?v=PPzIWFJU_3s&list=RDPPzIWFJU_3s&start_radio=1",
    "https://www.youtube.com/watch?v=0NDy6Rlijzo&list=RD0NDy6Rlijzo&start_radio=1",
    "https://www.youtube.com/shorts/BZcI5B5_YXE",
    "https://www.tiktok.com/@fada20252/video/7516020328758381854?_r=1&_t=ZN-8zLTWsrPJV0",
    "https://www.youtube.com/shorts/Nu2nIX-Rm4k",
    "https://www.tiktok.com/@jabez.elim/video/7501004773706059014?lang=en&utm_source=chatgpt.com",
    "https://www.tiktok.com/@_ki_be_/video/7417195969202097414",
    "https://www.tiktok.com/@viralgreenscreenhub/video/7541201896577453334?lang=en&utm_source=chatgpt.com",
    "https://www.tiktok.com/@realnatureplanet/video/7290261136283323690?lang=en&utm_source=chatgpt.com",
    "https://www.youtube.com/watch?v=H8-uYAVhaCs&list=PLHxODKxNtwmGmX1OjiUKv6jxF0T8RT-o6&index=20",
    "https://www.youtube.com/watch?v=BK7hGo_u70E&list=PLHxODKxNtwmGmX1OjiUKv6jxF0T8RT-o6&index=25",
    "https://www.youtube.com/watch?v=uUxChessSEY&list=PLHxODKxNtwmGmX1OjiUKv6jxF0T8RT-o6&index=33",
    "https://www.youtube.com/watch?v=U60oGYWZ92U&list=PLHxODKxNtwmGmX1OjiUKv6jxF0T8RT-o6&index=42",
    "https://www.youtube.com/watch?v=ZBJqnZy4qks&list=PLHxODKxNtwmGmX1OjiUKv6jxF0T8RT-o6&index=43",
    "https://www.youtube.com/watch?v=UbiShEn5_iA&list=PLHxODKxNtwmGmX1OjiUKv6jxF0T8RT-o6&index=47",
    "https://www.youtube.com/watch?v=qdbjNJkqSxQ&list=PLHxODKxNtwmGmX1OjiUKv6jxF0T8RT-o6&index=59",
    "https://www.youtube.com/watch?v=ADsSVaCG5C8&list=PLHxODKxNtwmGmX1OjiUKv6jxF0T8RT-o6&index=68",
    "https://www.youtube.com/watch?v=l-RJap7NDVs&list=PLHxODKxNtwmGmX1OjiUKv6jxF0T8RT-o6&index=72",
    "https://www.youtube.com/watch?v=Ltc-voYup4U&list=PLHxODKxNtwmGmX1OjiUKv6jxF0T8RT-o6&index=77"
  ];

  // === 2) Utilidades ===
  const $ = sel => document.querySelector(sel);
  const player = $("#player");
  const btnShuffle = $("#shuffle");
  const linkOpen = $("#openOriginal");
  const btnCopy = $("#copyLink");
  const meta = $("#meta");
  const sourceHost = $("#sourceHost");
  const sourceUrl = $("#sourceUrl");
  const counter = $("#counter");
  let lastIndex = -1;
  let currentUrl = null;
  let order = [];
  let idxInOrder = 0;
  let round = 1;
  // Intentar cargar el logo desde varios nombres comunes

  function makeOrder(prev) {
    order = Array.from({length: LINKS.length}, (_, i) => i);
    // Fisher‚ÄìYates shuffle
    for (let i = order.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [order[i], order[j]] = [order[j], order[i]];
    }
    // Evitar que la nueva ronda empiece con el mismo que termin√≥ la anterior
    if (typeof prev === 'number' && order.length > 1 && order[0] === prev) {
      [order[0], order[1]] = [order[1], order[0]];
    }
    idxInOrder = 0;
  }

  function nextIndex() {
    if (order.length === 0 || idxInOrder >= order.length) {
      if (order.length > 0) round += 1; // s√≥lo aumenta al completar una ronda
      makeOrder(lastIndex);
    }
    const i = order[idxInOrder++];
    lastIndex = i;
    return i;
  }

  function updateCounter() {
    if (!counter) return;
    const seen = Math.min(idxInOrder, LINKS.length);
    counter.hidden = false;
    counter.textContent = `Video ${seen}/${LINKS.length} ¬∑ ronda ${round}`;
  }
  


  function parseProvider(raw) {
    try {
      const url = new URL(raw);
      const host = url.hostname.replace(/^www\./, "");
      if (host.includes("tiktok.com")) {
        // Expect path like /@user/video/1234567890
        const m = url.pathname.match(/\/video\/(\d+)/);
        const id = m ? m[1] : null;
        return { provider: "tiktok", id, url: raw, host };
      }
      if (host.includes("youtube.com") || host === "youtu.be") {
        let id = null;
        if (url.pathname.startsWith("/shorts/")) {
          id = url.pathname.split("/")[2] || null;
        } else if (host === "youtu.be") {
          id = url.pathname.slice(1) || null;
        } else {
          id = url.searchParams.get("v");
        }
        return { provider: "youtube", id, url: raw, host };
      }
      return { provider: "link", id: null, url: raw, host };
    } catch (e) {
      return { provider: "link", id: null, url: raw, host: "url inv√°lida" };
    }
  }

  function clearPlayer() {
    player.innerHTML = "";
  }

  function renderYouTube(id) {
    const embed = document.createElement("iframe");
    embed.setAttribute("allowfullscreen", "");
    embed.setAttribute("loading", "lazy");
    embed.setAttribute("referrerpolicy", "strict-origin-when-cross-origin");
    embed.width = "100%"; embed.height = "100%";
    embed.src = `https://www.youtube.com/embed/${id}?rel=0&modestbranding=1`;
    player.appendChild(embed);
  }

  function renderTikTok(id, originalUrl) {
    // En lugar de embeber, informamos que debe abrirse en su app
    const msg = document.createElement("div");
    msg.className = "muted small";
    msg.style.textAlign = "center";
    msg.style.padding = "12px";
    msg.innerHTML = `Este video de TikTok no permite <em>embed</em>.<br/><a href="${originalUrl}" target="_blank" rel="noopener">√Åbrelo en su app</a>.`;
    player.appendChild(msg);
  }

  function showMeta(info) {
    linkOpen.hidden = false;
    linkOpen.disabled = false;
    currentUrl = info.url;
    btnCopy.hidden = false;
    meta.hidden = false;
    sourceHost.textContent = info.host;
    sourceUrl.textContent = info.url;
  }

  function pickRandom() {
    player.setAttribute("aria-busy", "true");
    clearPlayer();
    const raw = LINKS[nextIndex()];
    const info = parseProvider(raw);

    if (info.provider === "youtube" && info.id) {
      renderYouTube(info.id);
      showMeta(info);
    } else if (info.provider === "tiktok" && info.id) {
      renderTikTok(info.id, info.url);
      showMeta(info);
    } else {
      // Fallback: no compatible embed
      const msg = document.createElement("div");
      msg.className = "muted";
      msg.innerHTML = `No puedo embeber este enlace. <a href="${info.url}" target="_blank" rel="noopener">√Åbrelo aqu√≠</a>.`;
      player.appendChild(msg);
      showMeta(info);
    }

    player.removeAttribute("aria-busy");
    updateCounter();
  }

  btnShuffle.addEventListener("click", pickRandom);

  // Abrir en su app (como bot√≥n, no enlace)
  linkOpen.addEventListener("click", () => {
    if (currentUrl) window.open(currentUrl, "_blank", "noopener");
  });

  btnCopy.addEventListener("click", async () => {
    const url = currentUrl;
    try {
      await navigator.clipboard.writeText(url);
      btnCopy.textContent = "¬°Copiado!";
      setTimeout(() => (btnCopy.textContent = "Copiar enlace"), 1200);
    } catch {
      // Fallback
      alert("Copia manual: " + url);
    }
  });

  // Auto-inicio: selecciona uno al cargar
  // makeOrder(); // prepara la primera ronda
  // pickRandom(); // -> descomentarlo si quieres cargar uno autom√°ticamente
  </script>
</body>
</html>
